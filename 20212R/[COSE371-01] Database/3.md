## [ëª©ì°¨ë¡œ](./)

# Relational Algebra
Formal Relational Query Language ì¤‘ í•˜ë‚˜

DBMSê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€í•˜ê³  ì¢‹ì€ sqlì‘ì„±ì— ë„ì›€ì„ ì¤Œ

Procedural language(ì ˆì°¨ì  ì–¸ì–´)ì„.

- Six basic operators
> select, project, union, set difference, cartesian product, rename <br>
> `Ïƒ ğš· âˆª âˆ’ Ã— Ï`

- Additional operators
> Set intersection, Natural join, Assignment, Outer join <br>
> `âˆ© â¨ â† âŸ—`

- Extended relational algebra operators
> Generalized Projection, Aggregate Functions <br>
> `ğš· ğ’¢`

ê° operatorì˜ ì—°ì‚° ê°’ì€ relationì„.

# Query Processing Procedure
```
+-----+
|Users|
+-----+
      â†“ non-prodecural language query 
      â†“ `select * from r,s where r.A=r.B`
      â†“
+---------------<Relational DBMS>--------+
|         â†“
|    +------------------+
|    |Parse & Translator|
|    +------------------+
|         â†“
|    +-----------------------------+
|    |Relational Algebra Expression|   
|    +-----------------------------+   
|         â†“ Ïƒ_{r.A=r.B} (r X s)
|         â†“ // ë¹„íš¨ìœ¨ì ì¸ ì½”ë“œì„. ì´ˆì•ˆ
|    +---------+
|    |optimizer| 
|    +---------+
|         â†“ r â¨_{r.A=r.B} s
|         â†“ // ìµœì í™”
|    +----------------+
|    | execution plan |  
|    +----------------+
|         â†“
|    +--------------+
|    |execution code|
|    +--------------+
|         â†“
|    +----------------+
|    |evalution engine|  
|    +----------------+
|         â†“ // relational databaseí•˜ê³  í†µì‹ í•¨
+---------------<Relational DBMS>--------+
      â†“ query output
+-----+
|Users|
+-----+
```

# Six basic operators
## Select operation
ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” row ì„ íƒ

`Ïƒ_{p}(r) = {t | t in r and P(t)}`

`p`ëŠ” `âˆ§`, `âˆ¨`, `Â¬`ìœ¼ë¡œ ì—°ê²°ëœ operatorë“¤(`=`, `â‰ `, `>`, `â‰¥`, `<`, `â‰¤`)ì„.

ì˜ˆì‹œ `Ïƒ_{dept_name="Physics"}(instructor)`

```mysql
select *
from instructor
where dept_name="Physics"
```


## Project
íŠ¹ì • attribute ì„ íƒ

`ğš·_{A1, A2, ..., Ak}(r)`

relationì€ setì´ë¼ì„œ ì¤‘ë³µëœ rowëŠ” ê²°ê³¼ì—ì„œ ì œê±°ë¨. sqlì¿¼ë¦¬ëŠ” ê¸°ë³¸ì´ multisetì´ë¼ì„œ distinct í‚¤ì›Œë“œë¥¼ ì ì–´ì¤˜ì•¼ í•¨.
```mysql
select distinct(A, C)
from r
```


## Union
`r âˆª s = {t | t in r or t in s}`

`r`í•˜ê³  `s`ëŠ” attribute ê°œìˆ˜ê°€ ê°™ì•„ì•¼ í•¨. (same arity), ê·¸ë¦¬ê³  attribute domain ì´ í˜¸í™˜ ê°€ëŠ¥í•´ì•¼í•¨.
```mysql
(select A,B from r)
union
(select A,B from s)
```


## Set Difference
`r âˆ’ s = {t | t in r and t not in s}`

`r`í•˜ê³  `s`ëŠ” same arityí•˜ê³  attribute domainsê°€ compatibleí•´ì•¼ í•œë‹¤.
```mysql
(select A,B from r)
except # mysqlì—ì„œ except ê°™ì€ê±° ì—†ì–´ intersectë„ ì—†ì–´. union, union allë§Œ ìˆìŒ
(select A,B from s)

SELECT r.A, r.B
FROM r left join s
ON r.A=s.A AND r.B=s.B
WHERE s.x(s.A, s.B, s.ID ì•„ë¬´ê±°ë‚˜ pkê°€ ì¢‹ê² ì§€) IS NULL;
```

## Cartesian-Product
`r Ã— s = {t q | t in r and q in s}` tuple concatí•œ ê²ƒì„.

ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ë°ì´í„°ê°€ ë‘ê°œ ì´ìƒì˜ relationì— í©ì–´ì ¸ ìˆì–´ì„œ ì¼ë‹¨ í•˜ë‚˜ì˜ relationìœ¼ë¡œ í•©ì¹˜ëŠ” ê²ƒ

`r(R)`ì™€ `s(S)`ì˜ attributeê°€ disjointí•˜ë©´(`R âˆ© S = empty set`), renameì´ í•„ìš” ì—†ìŒ.

disjointí•˜ì§€ ì•Šìœ¼ë©´ renameê°€ í•„ìš”í•¨
```mysql
select * from r, s
```

## Rename
relationì´ë¦„ë§Œ ë°”ê¾¸ë ¤ë©´ `Ï_{x}(E)` attribute ì´ë¦„ê¹Œì§€ ë°”ê¾¸ë ¤ë©´ `Ï_{x(A1, A2, ..., An)}(E)`. `E`ëŠ” relational algebra expression: operationê²°ê³¼ë‚˜ relationì´ ë˜ì–´ì•¼ í•¨. 

# Additional operators
## Set Intersection
`r âˆ© s = {t | t in r and t in s}`

`r`ê³¼ `s`ëŠ” same arity, compatible attribute domain

`r âˆ© s = r - (r - s)`

```mysql
SELECT r.A, r.B
FROM r join s
ON r.A=s.A AND r.B=s.B
```
## Natural-Join
`r â¨ s`

`if r âˆ© s = âˆ…, then r â¨ s = r Ã— s`

`r â¨ s = ğš·_{r.A,r.B,r.C,r.D,r.E}(Ïƒ_{r.B=s.Bâˆ§r.D=s.D}(r x s))`
```mysql
select *
from r natural join s
```

### theta join
`r â¨_Î¸ s = Ïƒ_{Î¸}(r x s)`

## Assignment
ë³µì¡í•œ queryë¥¼ í¸ë¦¬í•˜ê²Œ ë‚˜íƒ€ë‚´ê¸° ìœ„í•œ ê²ƒ

`temp1 â† ğš·_{r.A,r.B,r.C,r.D,r.E}(Ïƒ_{r.B=s.Bâˆ§r.D=s.D}(r x s))`

## Outer Join
full outer join: `r âŸ— s`, left outer join: `âŸ—`ì—ì„œ ì™¼ìª½ë§Œ ìˆëŠ”ê±°, right outer join: `âŸ—`ì—ì„œ ì˜¤ë¥¸ìª½ë§Œ ìˆëŠ”ê±°

`join` operationì„ í•˜ë©´, rì—ëŠ” ìˆëŠ” tupleê°€ sì—ëŠ” ì¡´ì¬í•˜ì§€ ì•Šì„ ë•Œ, ê·¸ ì •ë³´ê°€ ì‚¬ë¼ì§. ì´ëŸ° ì •ë³´ ì†ì‹¤ì„ ë§‰ê¸° ìœ„í•œ operatorì„. 

`r left outer join s`ì€ rì˜ ì •ë³´ëŠ” ë‹¤ ë³´ì—¬ì¤Œ. rì—ëŠ” ìˆëŠ”ë° sì—ëŠ” ì—†ëŠ” ê²ƒì€ NULLê°’ìœ¼ë¡œ ì±„ì›Œì§.

`full outer join`ì€ mysqlì— ì—†ìŒ. `full join`ì—°ì‚°ì€ ìˆëŠ”ë° ì´ê±°ëŠ” `join`ì—°ì‚°ê³¼ ë™ì¼í•¨.

mysqlì—ì„œ joiní• ë•Œ ê·¸ ì¡°ê±´ìœ¼ë¡œ onë’¤ì— ì¡°ê±´ë¬¸ì„ ì ì„ ìˆ˜ ìˆìŒ. ê·¼ë° ë‚˜ì¤‘ì— whereë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒí•˜ê³  ë¬´ìŠ¨ ì°¨ì´ì„?

```mysql
left outer join
select * from r left [outer] join s on r.A=s.B;

right outer join
select * from r right [outer] join s on r.A=s.B;

full outer join
(select * from r left [outer] join s on r.A=s.B;)
union # union allì€ ì¤‘ë³µ ìš”ì†Œ í¬í•¨
(select * from r right [outer] join s on r.A=s.B;)
```

- ì°¸ê³ . mysqlì—ì„œì˜ joinë¬¸
> ê·¸ëƒ¥ joinì“°ë©´ innerë¡œ í•´ì„í•˜ê³ , leftë‚˜ rightëŠ” outerë¡œ í•´ì„í•¨
```
https://dev.mysql.com/doc/refman/8.0/en/join.html
table_reference NATURAL [INNER | {LEFT|RIGHT} [OUTER]] JOIN table_factor
```

# Extended relational algebra operators
## Generalize Projection
`ğš·_{F1, F2, ..., Fk}(r)`

ì¼ë°˜ì ì¸ `projecton`ì—ì„œ attribute ì„ íƒìê°€ arithmetic expressionì´ ë  ìˆ˜ ìˆìŒ. 

`ğš·_{ID, name, dept_name, salary/12}}(instructor)`

## Aggregate Functions and Operations
- Aggregate Functions
> avg, min, max, sum, count

`{G1, G2, ..., Gn}_ğ’¢_{F1(A1), F2(A2, ...), Fn(An)} (E)`

`G1, G2, ...`ëŠ” ê·¸ë£¹ì§€ì„ attributeë“¤. ì•ˆì ì–´ë„ ë¨.

`Fi`: aggregate functions: avg, min, ...

```mysql
select A1, A2, sum(A3)
from r1, r2, ..., rm
where P,
group by A1, A2
```

# Inner join vs Cartesian product(Cross join)
joinì¡°ê±´ ê°™ìœ¼ë©´ ê²°ê³¼ ê°™ìŒ.

https://stackoverflow.com/questions/17759687/cross-join-vs-inner-join-in-sql

https://stackoverflow.com/questions/44917/explicit-vs-implicit-sql-joins

Inner join
```mysql
select * 
from a join b 
on somecondition
```

Cartesian product
```mysql
select * 
from a, b
where somecondition
```


## [ëª©ì°¨ë¡œ](./)